{% extends 'movies/base.html' %}
{% load static %}


{% block main-content %}
<ol class="breadcrumb editContent">
    <li class="breadcrumb-item">
        <a href="index.html" class="editContent"
           style="outline: none; cursor: inherit;">Home</a>
    </li>
    <li class="breadcrumb-item active editContent" style="outline: none; cursor: inherit;">
        Single
    </li>
</ol>
{% endblock %}

{% block banner %}
<section class="ab-info-main py-md-5 py-4 editContent"
         style="outline: none; outline-offset: -2px; cursor: inherit; color: rgb(33, 37, 41); font-size: 16px; background-color: rgba(0, 0, 0, 0); font-family: Lato, sans-serif;">
    <div class="container py-md-3">
        <!-- top Products -->
        <div class="row">
            <!-- product left -->
            <div class="side-bar col-lg-4">

                <div class="search-bar w3layouts-newsletter">
                    <h3 class="sear-head editContent" style="outline: none; cursor: inherit;">
                        Поиск фильма</h3>
                    <form action="#" method="post" class="d-flex editContent"
                          style="outline: none; cursor: inherit;">
                        <input type="search" placeholder="Введите название..." name="search"
                               class="form-control" required="">
                        <button class="btn1 btn" style="outline: none; cursor: inherit;"><span
                                class="fa fa-search" aria-hidden="true"
                                style="outline: none; cursor: inherit;"></span></button>
                    </form>
                </div>
                <!--preference -->
                <div class="left-side my-4">
                    <h3 class="sear-head editContent" style="outline: none; cursor: inherit;">
                        Жанры</h3>
                    <ul class="w3layouts-box-list">
                        <li class="editContent" style="outline: none; cursor: inherit;">
                            <input type="checkbox" class="checked">
                            <span class="span editContent"
                                  style="outline: none; cursor: inherit;">Аниме</span>
                        </li>
                        <li class="editContent" style="outline: none; cursor: inherit;">
                            <input type="checkbox" class="checked">
                            <span class="span editContent"
                                  style="outline: none; cursor: inherit;">Боевики</span>
                        </li>
                        <li class="editContent" style="outline: none; cursor: inherit;">
                            <input type="checkbox" class="checked">
                            <span class="span editContent"
                                  style="outline: none; cursor: inherit;">Комедии</span>
                        </li>
                        <li class="editContent" style="outline: none; cursor: inherit;">
                            <input type="checkbox" class="checked">
                            <span class="span editContent"
                                  style="outline: none; cursor: inherit;">Ужасы</span>
                        </li>
                    </ul>
                </div>
                <!-- // preference -->
                <!-- discounts -->
                <div class="left-side">
                    <h3 class="sear-head editContent" style="outline: none; cursor: inherit;">
                        Год
                    </h3>
                    <ul class="w3layouts-box-list">
                        <li class="editContent" style="outline: none; cursor: inherit;">
                            <input type="checkbox" class="checked">
                            <span class="span editContent"
                                  style="outline: none; cursor: inherit;">2020</span>
                        </li>
                        <li class="editContent" style="outline: none; cursor: inherit;">
                            <input type="checkbox" class="checked">
                            <span class="span editContent"
                                  style="outline: none; cursor: inherit;">2019</span>
                        </li>
                        <li class="editContent" style="outline: none; cursor: inherit;">
                            <input type="checkbox" class="checked">
                            <span class="span editContent"
                                  style="outline: none; cursor: inherit;">2018</span>
                        </li>
                        <li>
                            <input type="checkbox" class="checked">
                            <span class="span editContent"
                                  style="outline: none; cursor: inherit;">2017</span>
                        </li>
                        <li class="editContent" style="outline: none; cursor: inherit;">
                            <input type="checkbox" class="checked">
                            <span class="span editContent"
                                  style="outline: none; cursor: inherit;">2016</span>
                        </li>
                        <li class="editContent" style="outline: none; cursor: inherit;">
                            <input type="checkbox" class="checked">
                            <span class="span editContent"
                                  style="outline: none; cursor: inherit;">2015</span>
                        </li>
                    </ul>
                </div>
                <!-- //discounts -->
                <!-- reviews -->
                <div class="customer-rev left-side my-4">
                    <h3 class="sear-head editContent" style="outline: none; cursor: inherit;">
                        Рейтинг</h3>
                    <ul class="w3layouts-box-list">
                        <li>
                            <a href="#">
                                    <span class="fa fa-star" aria-hidden="true"
                                          style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="editContent"
                                      style="outline: none; cursor: inherit;">5.0</span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                    <span class="fa fa-star" aria-hidden="true"
                                          style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star-o" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="editContent"
                                      style="outline: none; cursor: inherit;">4.0</span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                    <span class="fa fa-star" aria-hidden="true"
                                          style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star-half-o" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star-o" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="editContent"
                                      style="outline: none; cursor: inherit;">3.5</span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                    <span class="fa fa-star" aria-hidden="true"
                                          style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star" aria-hidden="true"></span>
                                <span class="fa fa-star-o" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star-o" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="editContent"
                                      style="outline: none; cursor: inherit;">3.0</span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <span class="fa fa-star" aria-hidden="true"></span>
                                <span class="fa fa-star" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star-half-o" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star-o" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="fa fa-star-o" aria-hidden="true"
                                      style="outline: none; cursor: inherit;"></span>
                                <span class="editContent"
                                      style="outline: none; cursor: inherit;">2.5</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- //reviews -->
                <!-- deals -->
                <div class="deal-leftmk left-side">
                    <h3 class="sear-head editContent">
                        Последние добавленные</h3>
                    <div class="special-sec1 row mt-3 editContent">
                        <div class="img-deals col-md-4">
                            <img src="bundles/images/s4.jpg" class="img-fluid" alt="">
                        </div>
                        <div class="img-deal1 col-md-4">
                            <h3 class="editContent">Рэмбо: Последняя кровь</h3>
                            <a href="shop-single.html" class="editContent"
                               style="outline: none; cursor: inherit;"></a>
                        </div>

                    </div>
                    <div class="special-sec1 row mt-3 editContent"
                         style="outline: none; cursor: inherit;">
                        <div class="img-deals col-md-4">
                            <img src="bundles/images/s2.jpg" class="img-fluid" alt=""
                                 style="outline: none; cursor: inherit;">
                        </div>
                        <div class="img-deal1 col-md-8">
                            <h3 class="editContent" style="outline: none; cursor: inherit;">
                                Холодное сердце 2</h3>
                            <a href="shop-single.html" class="editContent"
                               style="outline: none; cursor: inherit;"></a>
                        </div>

                    </div>
                    <div class="special-sec1 row mt-3 editContent"
                         style="outline: none; cursor: inherit;">
                        <div class="img-deals col-md-4">
                            <img src="bundles/images/s1.jpg" class="img-fluid" alt=""
                                 style="outline: none; cursor: inherit;">
                        </div>
                        <div class="img-deal1 col-md-8">
                            <h3 class="editContent" style="outline: none; cursor: inherit;">К
                                звездам</h3>
                            <a href="shop-single.html" class="editContent"
                               style="outline: none; cursor: inherit;"></a>
                        </div>

                    </div>
                    <div class="special-sec1 row mt-3 editContent"
                         style="outline: none; cursor: inherit;">
                        <div class="img-deals col-md-4">
                            <img src="bundles/images/s5.jpg" class="img-fluid" alt=""
                                 style="outline: none; cursor: inherit;">
                        </div>
                        <div class="img-deal1 col-md-8">
                            <h3 class="editContent" style="outline: none; cursor: inherit;">
                                Терминатор: Темные судьбы</h3>
                            <a href="shop-single.html" class="editContent"
                               style="outline: none; cursor: inherit;"></a>
                        </div>

                    </div>
                    <div class="special-sec1 row mt-3 editContent"
                         style="outline: none; cursor: inherit;">
                        <div class="img-deals col-md-4">
                            <img src="bundles/images/s3.jpg" class="img-fluid" alt=""
                                 style="outline: none; cursor: inherit;">
                        </div>
                        <div class="img-deal1 col-md-8">
                            <h3 class="editContent" style="outline: none; cursor: inherit;">
                                Джокер</h3>
                            <a href="shop-single.html" class="editContent"
                               style="outline: none; cursor: inherit;"></a>
                        </div>

                    </div>
                </div>
                <!-- //deals -->
                <!-- //deals -->

            </div>
            <!-- //product left -->
            <!-- product right -->
            <div class="left-ads-display col-lg-8">
                <div class="row">
                    <div class="desc1-left col-md-6">
                        <img src="{{ movie.poster.url }}" class="img-fluid" alt="">
                    </div>
                    <div class="desc1-right col-md-6 pl-lg-4">
                        <h3 class="editContent" style="outline: none; cursor: inherit;">
                            {{ movie.title }}
                        </h3>
                        <h5 class="editContent">Terminator: Dark Fate</h5>
                        <ul>
                            <li style="list-style: none"><span><b>Год:</b> {{ movie.year }}</span></li>
                            <li style="list-style: none"><span><b>Страна:</b> {{ movie.country }}</span>
                            </li>
                            <li style="list-style: none"><span><b>Слоган:</b> {{ movie.tagline }}</span>
                            </li>
                            <li style="list-style: none">
                                    <span><b>Режиссер:</b>
                                        <!--Так как режиссёры, актёры и жанры это связка многие ко многим, то их
                                        необходимо обрабатывать циклом.-->
                                        {% for director in movie.directors.all  %}
                                            {{ director.name }}
                                        {% endfor %}
                                    </span></li>
                            <li style="list-style: none">
                                    <span><b>Актеры:</b>
                                    {% for actor in movie.actors.all %}
                                        {{ actor.name }}
                                    {% endfor %}
                                    </span>
                            </li>
                            <li style="list-style: none"><span><b>Жанр:</b>
                                    {% for genre in movie.genres.all %}
                                        {{ genre.name }}
                                    {% endfor %}
                                </span>
                            </li>
                            <li style="list-style: none"><span><b>Премьера в мире:</b> {{ movie.world_premiere }}</span>
                            </li>
                            <li style="list-style: none">
                                <span><b>Бюджет:</b> {{ movie.budget }}</span></li>
                            <li style="list-style: none">
                                <span><b>Сборы в США:</b> {{ movie.fees_in_usa }}</span></li>
                            <li style="list-style: none"><span><b>Сборы в мире:</b> {{ movie.fees_in_world }}</span>
                            </li>
                            <li style="list-style: none">
                                <a href="#"><b>Рейтинг:</b>
                                    <span class="fa fa-star" aria-hidden="true"
                                          style="outline: none; cursor: inherit;"></span>
                                    <span class="fa fa-star" aria-hidden="true"
                                          style="outline: none; cursor: inherit;"></span>
                                    <span class="fa fa-star" aria-hidden="true"
                                          style="outline: none; cursor: inherit;"></span>
                                    <span class="fa fa-star" aria-hidden="true"
                                          style="outline: none; cursor: inherit;"></span>
                                    <span class="fa fa-star" aria-hidden="true"
                                          style="outline: none; cursor: inherit;"></span>
                                    <span class="editContent"
                                          style="outline: none; cursor: inherit;">5.0</span>
                                </a>
                            </li>
                            <div class="share-desc">
                                <div class="share">
                                    <h4 class="editContent"
                                        style="outline: none; cursor: inherit;">
                                        Share:</h4>
                                    <ul class="w3layouts_social_list list-unstyled">
                                        <li>
                                            <a href="#" class="w3pvt_facebook editContent"
                                               style="outline: none; cursor: inherit;">
                                                <span class="fa fa-facebook-f"
                                                      style="outline: none; cursor: inherit;"></span>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="w3pvt_twitter editContent"
                                               style="outline: none; cursor: inherit;">
                                                <span class="fa fa-twitter"
                                                      style="outline: none; cursor: inherit;"></span>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="w3pvt_dribble editContent"
                                               style="outline: none; cursor: inherit;">
                                                <span class="fa fa-dribbble"
                                                      style="outline: none; cursor: inherit;"></span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="clearfix"></div>
                            </div>
                    </div>
                </div>
                <div class="row sub-para-w3layouts mt-5">

                    <h3 class="shop-sing editContent" style="outline: none; cursor: inherit;">
                        О фильме {{ movie.title }}
                    </h3>
                    <p>
                        <!--Происходит обращение к модели movie и через неё забираем все объекты связанные с
                        movieshots.-->
                        {% for image in movie.movieshots_set.all %}
                            <img src="{{ image.image.url }}" class="img-movie-shots" alt="{{ image.description }}">
                        {% endfor %}
                    </p>
                    <p class="editContent" style="outline: none; cursor: inherit;">
                        {{ movie.description }}
                    </p>
                    <p class="mt-3 italic-blue editContent"
                       style="outline: none; cursor: inherit;">
                        <iframe width="560" height="315"
                                src="https://www.youtube.com/embed/A36LahZNUiE?controls=0"
                                frameborder="0" allow="accelerometer; autoplay;
                                                                           encrypted-media; gyroscope; picture-in-picture"
                                allowfullscreen>

                        </iframe>
                    </p>
                </div>
                <hr>
                <div class="row">
                    <div class="single-form-left">
                        <!-- contact form grid -->
                        <div class="contact-single">
                            <h3 class="editContent">
                                <!--Выводим количество отзывов у определённого фильма.-->
                                <span class="sub-tittle editContent">{{ movie.reviews_set.count }}</span>Оставить отзыв</h3>
                            <form action="{% url 'add_review' movie.id %}" method="post" class="mt-4" id="formReview">
                                {% csrf_token %}
                                <!--Добавляем через input возможность отвечать на какой-то определённый отзыв по id.-->
                                <input type="hidden" name="parent" id="contactparent" value="">
                                <div class="form-group editContent">
                                    <label for="contactcomment" class="editContent">
                                        Ваш комментарий *
                                    </label>
                                    <textarea class="form-control border" rows="5"
                                              id="contactcomment" required="" name="text"></textarea>
                                </div>
                                <div class="d-sm-flex">
                                    <div class="col-sm-6 form-group p-0 editContent">
                                        <label for="contactusername" class="editContent">
                                            Имя *
                                        </label>
                                        <input type="text" class="form-control border"
                                               id="contactusername" required="" name="name">
                                    </div>
                                    <div class="col-sm-6 form-group ml-sm-3 editContent">
                                        <label for="contactemail" class="editContent">
                                            Email *
                                        </label>
                                        <input type="email" class="form-control border"
                                               id="contactemail" required="" name="email">
                                    </div>
                                </div>
                                <button type="submit" class="mt-3 btn btn-success btn-block py-3">
                                    Отправить
                                </button>
                            </form>
                        </div>
                        <!--  //contact form grid ends here -->
                    </div>
                    {% for review in movie.get_review %}
                    <div class="media py-5">
                        <!--Выводим изображение по умолчанию у каждого отзыва.-->
                        <img src="{% static 'images/te2.jpg' %}" class="mr-3 img-fluid" alt="image">
                        <div class="media-body mt-4">
                            <h5 class="mt-0 editContent">
                                {{ review.name }}
                            </h5>
                            <p class="mt-2 editContent">
                                {{ review.text }}
                            </p>
                            <!--Добавляем ссылку к отзывам, чтобы можно было оставить свой отзыв. При клике на данную
                            ссылку пользователь будет подниматься к форме отправки отзывов. Передаём имя и id того
                            пользователя, на чей отзыв хотим ответить.-->
                            <a href="#formReview" onclick="addReview('{{ review.name }}', '{{ review.id }}')">Ответить</a>
                            {% for rew in review.reviews_set.all %}
                                <div class="media mt-5 editContent">
                                    <a class="pr-3" href="#">
                                        <img src="{% static 'images/te1.jpg' %}" class="img-fluid" alt="image">
                                    </a>
                                    <div class="media-body">
                                        <h5 class="mt-0 editContent">
                                            {{ rew.name }}
                                        </h5>
                                        <p class="mt-2 editContent">
                                            {{ rew.text }}
                                        </p>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            <!--Данная функция находит на странице поле parent и подставляет в атрибут value значение id, которое
            пришло. Далее по id находим поле отзывов и добавляем в него имя пользователя.-->
            <script>
                function addReview(name, id) {
                    document.getElementById('contactparent').value = id;
                    document.getElementById('contactcomment').innerText = `${name}, `
                }
            </script>
        </div>
    </div>
</section>
{% endblock %}